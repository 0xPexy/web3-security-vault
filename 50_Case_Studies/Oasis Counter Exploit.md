#case-study #centralization
Oasis Counter Exploit is the case of [[Contract Centralization]]. The team exploited their own centralization and moved the attacker funds by force. Although this ends up with the good result, this is actually the vulnerability.

## Concept
The hackers who exploited the Wormhole Bridge distributed the funds into multiple dApps including Oasis. The victims requested the UK court to order the centralization vulnerability in the Oasis to retrieve the stolen funds. That was accepted and the assets from attacker's vault were recovered.

### ELI5
There is special cutting-edge safe boxes in a bank to protect the customers' assets. Each box is can be opened only by the key of each customer, except one case. If the bank manager says "Fire!", the boxes are opened and the assets are moved to the safe bunker.
One day, a thief stole $10B and stored to this bank. The police requested the manager to open the safe box by saying "Fire!", so the money were recovered. This might be a happy ending, but in fact the "Fire!" is a master key can be used to exploit the whole funds. 

## Background
### Wormhole exploited
The [[Wormhole Exploit]] was done in Feb 2022 and the attacker distributed exploited funds to various DeFi platforms, including the Oasis.app. 
### Vulnerability in multi-sig
Oasis adopted [[Multi-Signatures]] to patch vulnerabilities for protecting user assets. White-hats informed the problems of the admin multi-sig design in on 16 Feb.
### UK Court Order
The UK Court ordered Oasis to exploit the centralization itself to recover the stolen funds.

## Process
1. Oasis changed the `Executor` address in `ServiceRegistry` to Oasis multi-sig wallet. This point is centralized to modify the address.
2. `AutomationBot::execute` calls the `Executor` from the `ServiceRegistry`, passes the authority to close the original attacker's vault and send assets to recovery address.

## Implications
Somebodies might think it's done with happy ending, but this case exactly shows the possibilities of behaviors like rug pulls if the access control is centralized.

## References
- [UK Court Ordered Oasis to Exploit Own Security Flaw to Recover 120k wETH Stolen in Wormhole Hack](https://medium.com/@observer1/uk-court-ordered-oasis-to-exploit-own-security-flaw-to-recover-120k-weth-stolen-in-wormhole-hack-fcadc439ca9d)
- [Jump & Oasis Crypto Counter-Exploit Hack Analysis](https://blog.solidityscan.com/jump-oasis-crypto-counter-exploit-hack-analysis-7aa4c824d9cb)
